{% for order in orders %}
<tr class="{% cycle 'bg-white' 'bg-gray-50' %} border-b border-gray-200 fade-in">
    <td class="edit-mode-column px-4 py-3" style="display: none;">
        <input
            type="checkbox"
            class="w-5 h-5 accent-stone-600 cursor-pointer order-checkbox"
            value="{{ order.id }}"
            aria-label="Select order {{ order.id }}"
        >
    </td>
    <td class="px-4 py-3 text-sm">{{ order.customer_name }}</td>
    <td class="px-4 py-3 text-sm">{{ order.customer_email }}</td>
    <td class="px-4 py-3 text-sm">{{ order.created_at|date:"M d, Y h:i a" }}</td>

    <td class="px-4 py-3 text-sm">
        <button type="button"
                class="text-stone-700 font-medium hover:text-stone-900 flex items-center gap-1"
                onclick="this.nextElementSibling.classList.toggle('hidden')">
            View Items
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <ul class="list-disc pl-5 mt-1 space-y-1 hidden">
            {% for item in order.items.all %}
            <li>
                {{ item.quantity }} × {{ item.product_name }} -
                {{ item.product_category }} ({{ item.size }})
                {% if item.back_name %} – "{{ item.back_name }}"{% endif %}
            </li>
            {% endfor %}
        </ul>
    </td>

    {% if order.has_paid %}
    <td class="px-4 py-3 text-center text-sm">
        <div class="flex justify-center">
            <div class="w-5 h-5 flex items-center justify-center rounded-full bg-green-500">
                <svg xmlns="http://www.w3.org/2000/svg"
                     class="w-3 h-3 text-white"
                     viewBox="0 0 20 20"
                     fill="currentColor">
                    <path fill-rule="evenodd"
                          d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                          clip-rule="evenodd" />
                </svg>
            </div>
        </div>
    </td>
    {% else %}
    <td class="px-4 py-3 text-center text-sm"></td>
    {% endif %}
</tr>
{% empty %}
<tr class="empty-orders-row">
    <td colspan="7" class="px-4 py-8 text-center text-gray-500">
        No orders yet.
    </td>
</tr>
{% endfor %}

{% if has_next %}
<tr id="loading-spinner-row"
    hx-get="{% url 'order:order_list' %}?page={{ next_page }}"
    hx-trigger="intersect once"
    hx-swap="outerHTML">
    <td colspan="7" class="px-4 py-4">
        <div class="flex justify-center">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-stone-600"></div>
        </div>
    </td>
</tr>
{% endif %}